@startuml シュレッダー画面状態遷移図

title ヨルノートアプリ - シュレッダー画面状態遷移図

[*] --> ShredderView表示

state ShredderView表示 {
    [*] --> 初期状態
    
    state 初期状態 {
        [*] --> ダークテーマ適用
        ダークテーマ適用 --> タイマー表示
        タイマー表示 --> テキストエディタ表示
        テキストエディタ表示 --> 破棄ボタン表示
        破棄ボタン表示 --> 入力待機
        
        state 入力待機 {
            [*] --> テキスト入力検知
            テキスト入力検知 --> タイマー開始 : 最初の文字入力
            テキスト入力検知 --> 入力継続 : 追加入力
            入力継続 --> テキスト入力検知
        }
        
        入力待機 --> シュレッダー実行 : "スッキリする"ボタンタップ
    }
    
    state タイマー開始 {
        [*] --> カウントダウン中
        
        state カウントダウン中 {
            [*] --> 60秒から開始
            60秒から開始 --> 1秒減算 : Timer.publish
            1秒減算 --> 時間チェック
            時間チェック --> 1秒減算 : timeRemaining > 0
            時間チェック --> 自動シュレッダー実行 : timeRemaining == 0
        }
        
        カウントダウン中 --> シュレッダー実行 : "スッキリする"ボタンタップ
    }
    
    シュレッダー実行 --> シュレッダー処理
    自動シュレッダー実行 --> シュレッダー処理
}

state シュレッダー処理 {
    [*] --> タイマー停止
    タイマー停止 --> アニメーション開始
    アニメーション開始 --> シュレッダーアニメーション表示
    
    state シュレッダーアニメーション表示 {
        [*] --> ゴミ箱アイコン表示
        ゴミ箱アイコン表示 --> 消去メッセージ表示
        消去メッセージ表示 --> 2秒待機
        2秒待機 --> アニメーション完了
    }
    
    アニメーション完了 --> 完了画面表示
}

state 完了画面表示 {
    [*] --> 完了メッセージ表示
    完了メッセージ表示 --> リセットボタン表示
    リセットボタン表示 --> リセット待機
    
    state リセット待機 {
        [*] --> ユーザー操作待ち
        ユーザー操作待ち --> リセット処理 : "もう一度書く"ボタンタップ
    }
}

state リセット処理 {
    [*] --> 状態初期化
    状態初期化 --> テキストクリア
    テキストクリア --> タイマーリセット
    タイマーリセット --> 初期状態
}

note right of 初期状態
  60秒タイマー表示
  黒背景のダークテーマ
  白文字のTextEditor
  赤色のスッキリするボタン（無効状態）
end note

note right of カウントダウン中
  Timer.publish(every: 1, on: .main)
  リアルタイムでカウントダウン表示
  テキスト入力も並行して可能
end note

note right of 完了画面表示
  ✨ アイコン表示
  "頭の中が空っぽになりました"の表示
  テキストデータは完全消去
end note

@enduml